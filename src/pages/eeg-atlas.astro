---
import BaseLayout from '../layouts/BaseLayout.astro';
import EEGAtlasCard from '../components/EEGAtlasCard.astro';
import AnnotatedEEG from '../components/AnnotatedEEG.astro';
import { allPatterns, basicPatterns, intermediatePatterns, advancedPatterns } from '../data/eeg-atlas';
import {
  allBrainImagingPatterns,
  basicPatterns as mriBasic,
  intermediatePatterns as mriIntermediate,
  advancedPatterns as mriAdvanced,
} from '../data/brain-imaging';
---

<BaseLayout title="Diagnostic Atlas">
  <!-- Hero Section -->
  <section id="atlas-hero" class="bg-gradient-to-br from-amber-700 via-amber-600 to-yellow-500 text-white transition-all duration-500">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 sm:py-14">
      <div class="text-center max-w-3xl mx-auto">
        <div class="inline-flex items-center gap-2 bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full text-sm mb-4">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
          </svg>
          Interactive Learning Resource
        </div>
        <h1 id="atlas-title" class="text-3xl sm:text-4xl font-extrabold mb-3 leading-tight">
          Pediatric Diagnostic Atlas
        </h1>

        <!-- Modality tabs -->
        <div class="flex items-center justify-center gap-3 mb-5">
          <button id="tab-eeg" class="modality-tab active px-5 py-2 rounded-full text-sm font-semibold bg-white/25 backdrop-blur-sm border-2 border-white/50 hover:bg-white/30 transition-all">
            EEG Patterns
          </button>
          <button id="tab-mri" class="modality-tab px-5 py-2 rounded-full text-sm font-semibold bg-white/10 backdrop-blur-sm border-2 border-white/20 hover:bg-white/20 transition-all">
            Brain Imaging
          </button>
        </div>

        <p id="atlas-subtitle" class="text-sm text-amber-100 mb-5 leading-relaxed">
          Interactive annotated EEG patterns organized from basic to advanced.
          Click or hover on numbered markers to explore key features.
        </p>

        <!-- EEG stats -->
        <div id="eeg-stats" class="flex items-center justify-center gap-6 text-sm">
          <span class="flex items-center gap-1.5">
            <span class="w-3 h-3 rounded-full bg-green-400"></span>
            {basicPatterns.length} Basic
          </span>
          <span class="flex items-center gap-1.5">
            <span class="w-3 h-3 rounded-full bg-amber-300"></span>
            {intermediatePatterns.length} Intermediate
          </span>
          <span class="flex items-center gap-1.5">
            <span class="w-3 h-3 rounded-full bg-red-400"></span>
            {advancedPatterns.length} Advanced
          </span>
        </div>
        <!-- MRI stats (hidden by default) -->
        <div id="mri-stats" class="hidden flex items-center justify-center gap-6 text-sm">
          <span class="flex items-center gap-1.5">
            <span class="w-3 h-3 rounded-full bg-green-400"></span>
            {mriBasic.length} Basic
          </span>
          <span class="flex items-center gap-1.5">
            <span class="w-3 h-3 rounded-full bg-amber-300"></span>
            {mriIntermediate.length} Intermediate
          </span>
          <span class="flex items-center gap-1.5">
            <span class="w-3 h-3 rounded-full bg-red-400"></span>
            {mriAdvanced.length} Advanced
          </span>
        </div>
      </div>
    </div>
  </section>

  <!-- ===================== EEG CONTENT ===================== -->
  <section id="eeg-content" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Filter tabs -->
    <div class="flex items-center gap-2 mb-6 overflow-x-auto pb-2">
      <button class="eeg-filter-btn atlas-filter-btn active px-4 py-2 rounded-lg text-sm font-medium bg-blue-600 text-white" data-filter="all">
        All ({allPatterns.length})
      </button>
      <button class="eeg-filter-btn atlas-filter-btn px-4 py-2 rounded-lg text-sm font-medium bg-slate-100 text-slate-600 hover:bg-slate-200" data-filter="basic">
        Basic ({basicPatterns.length})
      </button>
      <button class="eeg-filter-btn atlas-filter-btn px-4 py-2 rounded-lg text-sm font-medium bg-slate-100 text-slate-600 hover:bg-slate-200" data-filter="intermediate">
        Intermediate ({intermediatePatterns.length})
      </button>
      <button class="eeg-filter-btn atlas-filter-btn px-4 py-2 rounded-lg text-sm font-medium bg-slate-100 text-slate-600 hover:bg-slate-200" data-filter="advanced">
        Advanced ({advancedPatterns.length})
      </button>
    </div>

    <!-- Card grid -->
    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 mb-12" id="eeg-card-grid">
      {allPatterns.map(pattern => (
        <EEGAtlasCard
          id={pattern.id}
          title={pattern.title}
          imagePath={pattern.imagePath}
          difficulty={pattern.difficulty}
          syndrome={pattern.syndrome}
          description={pattern.description}
          annotationCount={pattern.annotations.length}
          modality="eeg"
        />
      ))}
    </div>

    <!-- Full viewers -->
    <div class="space-y-8" id="eeg-viewers">
      <div class="eeg-section atlas-section" data-section="basic">
        <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
          <span class="w-3 h-3 rounded-full bg-green-500"></span>
          Basic Patterns
        </h2>
        {basicPatterns.map(pattern => (
          <AnnotatedEEG
            id={pattern.id}
            title={pattern.title}
            imagePath={pattern.imagePath}
            imageAlt={pattern.imageAlt}
            annotations={pattern.annotations}
            difficulty={pattern.difficulty}
            syndrome={pattern.syndrome}
            frequency={pattern.frequency}
            distribution={pattern.distribution}
            clinicalSignificance={pattern.clinicalSignificance}
            source={pattern.source}
            license={pattern.license}
            modality="eeg"
          />
        ))}
      </div>

      <div class="eeg-section atlas-section" data-section="intermediate">
        <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
          <span class="w-3 h-3 rounded-full bg-amber-500"></span>
          Intermediate Patterns
        </h2>
        {intermediatePatterns.map(pattern => (
          <AnnotatedEEG
            id={pattern.id}
            title={pattern.title}
            imagePath={pattern.imagePath}
            imageAlt={pattern.imageAlt}
            annotations={pattern.annotations}
            difficulty={pattern.difficulty}
            syndrome={pattern.syndrome}
            frequency={pattern.frequency}
            distribution={pattern.distribution}
            clinicalSignificance={pattern.clinicalSignificance}
            source={pattern.source}
            license={pattern.license}
            modality="eeg"
          />
        ))}
      </div>

      <div class="eeg-section atlas-section" data-section="advanced">
        <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
          <span class="w-3 h-3 rounded-full bg-red-500"></span>
          Advanced Patterns
        </h2>
        {advancedPatterns.map(pattern => (
          <AnnotatedEEG
            id={pattern.id}
            title={pattern.title}
            imagePath={pattern.imagePath}
            imageAlt={pattern.imageAlt}
            annotations={pattern.annotations}
            difficulty={pattern.difficulty}
            syndrome={pattern.syndrome}
            frequency={pattern.frequency}
            distribution={pattern.distribution}
            clinicalSignificance={pattern.clinicalSignificance}
            source={pattern.source}
            license={pattern.license}
            modality="eeg"
          />
        ))}
      </div>
    </div>

    <!-- Real EEG Image Resources -->
    <div id="eeg-resources" class="mt-12 rounded-xl border border-blue-200 bg-gradient-to-br from-blue-50 to-indigo-50 p-6">
      <div class="flex items-start gap-3 mb-4">
        <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center flex-shrink-0">
          <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </div>
        <div>
          <h2 class="text-lg font-bold text-slate-800">Real EEG Image Resources</h2>
          <p class="text-sm text-slate-600 mt-1">
            The diagrams above are educational illustrations. For real clinical EEG recordings, explore these open-access resources:
          </p>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <a href="https://www.ncbi.nlm.nih.gov/books/NBK390354/" target="_blank" rel="noopener noreferrer"
           class="block p-4 bg-white rounded-lg border border-slate-200 hover:border-blue-400 hover:shadow-md transition-all group">
          <div class="flex items-center gap-2 mb-2">
            <span class="px-2 py-0.5 bg-green-100 text-green-800 text-[10px] font-semibold rounded">Free</span>
            <h3 class="text-sm font-bold text-slate-800 group-hover:text-blue-700">NCBI EEG Atlas (AES)</h3>
            <svg class="w-3.5 h-3.5 text-slate-400 ml-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
          </div>
          <p class="text-xs text-slate-500 leading-relaxed">American Epilepsy Society atlas with real EEG recordings covering normal and abnormal findings. CC BY-NC-SA 4.0.</p>
        </a>
        <a href="https://www.ncbi.nlm.nih.gov/books/NBK390356/" target="_blank" rel="noopener noreferrer"
           class="block p-4 bg-white rounded-lg border border-slate-200 hover:border-blue-400 hover:shadow-md transition-all group">
          <div class="flex items-center gap-2 mb-2">
            <span class="px-2 py-0.5 bg-green-100 text-green-800 text-[10px] font-semibold rounded">Free</span>
            <h3 class="text-sm font-bold text-slate-800 group-hover:text-blue-700">Developmental EEG (NCBI)</h3>
            <svg class="w-3.5 h-3.5 text-slate-400 ml-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
          </div>
          <p class="text-xs text-slate-500 leading-relaxed">Premature, neonatal, infant, and childhood EEG patterns with real clinical recordings and age-specific features.</p>
        </a>
        <a href="https://www.epilepsydiagnosis.org/" target="_blank" rel="noopener noreferrer"
           class="block p-4 bg-white rounded-lg border border-slate-200 hover:border-blue-400 hover:shadow-md transition-all group">
          <div class="flex items-center gap-2 mb-2">
            <span class="px-2 py-0.5 bg-blue-100 text-blue-800 text-[10px] font-semibold rounded">ILAE</span>
            <h3 class="text-sm font-bold text-slate-800 group-hover:text-blue-700">EpilepsyDiagnosis.org</h3>
            <svg class="w-3.5 h-3.5 text-slate-400 ml-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
          </div>
          <p class="text-xs text-slate-500 leading-relaxed">ILAE official diagnostic manual with real EEG examples, video-EEG correlates, and MRI images for each epilepsy syndrome.</p>
        </a>
        <a href="https://eeg-atlas.com/" target="_blank" rel="noopener noreferrer"
           class="block p-4 bg-white rounded-lg border border-slate-200 hover:border-blue-400 hover:shadow-md transition-all group">
          <div class="flex items-center gap-2 mb-2">
            <span class="px-2 py-0.5 bg-green-100 text-green-800 text-[10px] font-semibold rounded">Free</span>
            <h3 class="text-sm font-bold text-slate-800 group-hover:text-blue-700">EEG-Atlas.com</h3>
            <svg class="w-3.5 h-3.5 text-slate-400 ml-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
          </div>
          <p class="text-xs text-slate-500 leading-relaxed">Online EEG atlas based on the Cleveland Classification with interactive recordings and clinical annotations.</p>
        </a>
        <a href="https://www.acns.org/research/critical-care-eeg-monitoring-research-consortium-ccemrc/education" target="_blank" rel="noopener noreferrer"
           class="block p-4 bg-white rounded-lg border border-slate-200 hover:border-blue-400 hover:shadow-md transition-all group">
          <div class="flex items-center gap-2 mb-2">
            <span class="px-2 py-0.5 bg-purple-100 text-purple-800 text-[10px] font-semibold rounded">ACNS</span>
            <h3 class="text-sm font-bold text-slate-800 group-hover:text-blue-700">ACNS Critical Care EEG</h3>
            <svg class="w-3.5 h-3.5 text-slate-400 ml-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
          </div>
          <p class="text-xs text-slate-500 leading-relaxed">ACNS standardized EEG terminology (2021) with training modules, real EEG examples, and self-assessment tools.</p>
        </a>
        <a href="https://www.epilepsydiagnosis.org/syndrome/ects-eeg.html" target="_blank" rel="noopener noreferrer"
           class="block p-4 bg-white rounded-lg border border-slate-200 hover:border-blue-400 hover:shadow-md transition-all group">
          <div class="flex items-center gap-2 mb-2">
            <span class="px-2 py-0.5 bg-blue-100 text-blue-800 text-[10px] font-semibold rounded">ILAE</span>
            <h3 class="text-sm font-bold text-slate-800 group-hover:text-blue-700">SeLECTS EEG Examples</h3>
            <svg class="w-3.5 h-3.5 text-slate-400 ml-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
          </div>
          <p class="text-xs text-slate-500 leading-relaxed">ILAE detailed EEG examples for SeLECTS (Rolandic) showing centrotemporal spikes, horizontal dipole, and sleep activation.</p>
        </a>
      </div>
    </div>

    <div class="mt-8 text-center" id="eeg-back-link">
      <a href="/articles/epilepsy/pediatric-eeg-interpretation" class="inline-flex items-center gap-2 text-blue-600 hover:text-blue-800 font-medium">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        Back to Pediatric EEG Interpretation article
      </a>
    </div>
  </section>

  <!-- ===================== BRAIN IMAGING CONTENT ===================== -->
  <section id="mri-content" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Filter tabs -->
    <div class="flex items-center gap-2 mb-6 overflow-x-auto pb-2">
      <button class="mri-filter-btn atlas-filter-btn active px-4 py-2 rounded-lg text-sm font-medium bg-purple-600 text-white" data-filter="all">
        All ({allBrainImagingPatterns.length})
      </button>
      <button class="mri-filter-btn atlas-filter-btn px-4 py-2 rounded-lg text-sm font-medium bg-slate-100 text-slate-600 hover:bg-slate-200" data-filter="basic">
        Basic ({mriBasic.length})
      </button>
      <button class="mri-filter-btn atlas-filter-btn px-4 py-2 rounded-lg text-sm font-medium bg-slate-100 text-slate-600 hover:bg-slate-200" data-filter="intermediate">
        Intermediate ({mriIntermediate.length})
      </button>
      <button class="mri-filter-btn atlas-filter-btn px-4 py-2 rounded-lg text-sm font-medium bg-slate-100 text-slate-600 hover:bg-slate-200" data-filter="advanced">
        Advanced ({mriAdvanced.length})
      </button>
    </div>

    <!-- Card grid -->
    <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 mb-12" id="mri-card-grid">
      {allBrainImagingPatterns.map(pattern => (
        <EEGAtlasCard
          id={pattern.id}
          title={pattern.title}
          imagePath={pattern.imagePath}
          difficulty={pattern.difficulty}
          syndrome={pattern.syndrome}
          description={pattern.description}
          annotationCount={pattern.annotations.length}
          modality="mri"
        />
      ))}
    </div>

    <!-- Full viewers -->
    <div class="space-y-8" id="mri-viewers">
      <div class="mri-section atlas-section" data-section="basic">
        <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
          <span class="w-3 h-3 rounded-full bg-green-500"></span>
          Basic Patterns
        </h2>
        {mriBasic.map(pattern => (
          <AnnotatedEEG
            id={pattern.id}
            title={pattern.title}
            imagePath={pattern.imagePath}
            imageAlt={pattern.imageAlt}
            annotations={pattern.annotations}
            difficulty={pattern.difficulty}
            syndrome={pattern.syndrome}
            sequence={pattern.sequence}
            plane={pattern.plane}
            clinicalSignificance={pattern.clinicalSignificance}
            source={pattern.source}
            license={pattern.license}
            modality="mri"
          />
        ))}
      </div>

      <div class="mri-section atlas-section" data-section="intermediate">
        <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
          <span class="w-3 h-3 rounded-full bg-amber-500"></span>
          Intermediate Patterns
        </h2>
        {mriIntermediate.map(pattern => (
          <AnnotatedEEG
            id={pattern.id}
            title={pattern.title}
            imagePath={pattern.imagePath}
            imageAlt={pattern.imageAlt}
            annotations={pattern.annotations}
            difficulty={pattern.difficulty}
            syndrome={pattern.syndrome}
            sequence={pattern.sequence}
            plane={pattern.plane}
            clinicalSignificance={pattern.clinicalSignificance}
            source={pattern.source}
            license={pattern.license}
            modality="mri"
          />
        ))}
      </div>

      <div class="mri-section atlas-section" data-section="advanced">
        <h2 class="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
          <span class="w-3 h-3 rounded-full bg-red-500"></span>
          Advanced Patterns
        </h2>
        {mriAdvanced.map(pattern => (
          <AnnotatedEEG
            id={pattern.id}
            title={pattern.title}
            imagePath={pattern.imagePath}
            imageAlt={pattern.imageAlt}
            annotations={pattern.annotations}
            difficulty={pattern.difficulty}
            syndrome={pattern.syndrome}
            sequence={pattern.sequence}
            plane={pattern.plane}
            clinicalSignificance={pattern.clinicalSignificance}
            source={pattern.source}
            license={pattern.license}
            modality="mri"
          />
        ))}
      </div>
    </div>

    <!-- Brain Imaging Resources -->
    <div id="mri-resources" class="mt-12 rounded-xl border border-purple-200 bg-gradient-to-br from-purple-50 to-indigo-50 p-6">
      <div class="flex items-start gap-3 mb-4">
        <div class="w-10 h-10 bg-purple-600 rounded-lg flex items-center justify-center flex-shrink-0">
          <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
          </svg>
        </div>
        <div>
          <h2 class="text-lg font-bold text-slate-800">Brain Imaging Resources</h2>
          <p class="text-sm text-slate-600 mt-1">
            The diagrams above are educational illustrations. For real clinical neuroimaging, explore these resources:
          </p>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <a href="https://radiopaedia.org/articles/paediatric-brain?lang=us" target="_blank" rel="noopener noreferrer"
           class="block p-4 bg-white rounded-lg border border-slate-200 hover:border-purple-400 hover:shadow-md transition-all group">
          <div class="flex items-center gap-2 mb-2">
            <span class="px-2 py-0.5 bg-green-100 text-green-800 text-[10px] font-semibold rounded">Free</span>
            <h3 class="text-sm font-bold text-slate-800 group-hover:text-purple-700">Radiopaedia â€” Pediatric Brain</h3>
            <svg class="w-3.5 h-3.5 text-slate-400 ml-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
          </div>
          <p class="text-xs text-slate-500 leading-relaxed">Comprehensive open-access radiology reference with pediatric brain imaging cases, anatomy tutorials, and pathology examples.</p>
        </a>
        <a href="https://www.ajnr.org/content/by/section/Pediatric%20Neuroimaging" target="_blank" rel="noopener noreferrer"
           class="block p-4 bg-white rounded-lg border border-slate-200 hover:border-purple-400 hover:shadow-md transition-all group">
          <div class="flex items-center gap-2 mb-2">
            <span class="px-2 py-0.5 bg-purple-100 text-purple-800 text-[10px] font-semibold rounded">AJNR</span>
            <h3 class="text-sm font-bold text-slate-800 group-hover:text-purple-700">AJNR Pediatric Neuroimaging</h3>
            <svg class="w-3.5 h-3.5 text-slate-400 ml-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
          </div>
          <p class="text-xs text-slate-500 leading-relaxed">American Journal of Neuroradiology peer-reviewed cases and reviews in pediatric neuroimaging with high-quality images.</p>
        </a>
        <a href="https://www.epilepsydiagnosis.org/" target="_blank" rel="noopener noreferrer"
           class="block p-4 bg-white rounded-lg border border-slate-200 hover:border-purple-400 hover:shadow-md transition-all group">
          <div class="flex items-center gap-2 mb-2">
            <span class="px-2 py-0.5 bg-blue-100 text-blue-800 text-[10px] font-semibold rounded">ILAE</span>
            <h3 class="text-sm font-bold text-slate-800 group-hover:text-purple-700">ILAE Neuroimaging Commission</h3>
            <svg class="w-3.5 h-3.5 text-slate-400 ml-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
          </div>
          <p class="text-xs text-slate-500 leading-relaxed">ILAE recommended epilepsy MRI protocols, structural imaging guidelines, and educational materials for neuroimaging in epilepsy.</p>
        </a>
        <a href="https://brain-development.org/" target="_blank" rel="noopener noreferrer"
           class="block p-4 bg-white rounded-lg border border-slate-200 hover:border-purple-400 hover:shadow-md transition-all group">
          <div class="flex items-center gap-2 mb-2">
            <span class="px-2 py-0.5 bg-green-100 text-green-800 text-[10px] font-semibold rounded">Free</span>
            <h3 class="text-sm font-bold text-slate-800 group-hover:text-purple-700">Brain Development Database</h3>
            <svg class="w-3.5 h-3.5 text-slate-400 ml-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
          </div>
          <p class="text-xs text-slate-500 leading-relaxed">Normative pediatric brain MRI data from the Brain Development Cooperative Group for developmental comparison and research.</p>
        </a>
      </div>
    </div>
  </section>
</BaseLayout>

<script>
  // ==================== MODALITY TAB SWITCHING ====================
  const tabEeg = document.getElementById('tab-eeg');
  const tabMri = document.getElementById('tab-mri');
  const eegContent = document.getElementById('eeg-content');
  const mriContent = document.getElementById('mri-content');
  const hero = document.getElementById('atlas-hero');
  const subtitle = document.getElementById('atlas-subtitle');
  const eegStats = document.getElementById('eeg-stats');
  const mriStats = document.getElementById('mri-stats');

  function switchToEeg() {
    // Tab styles
    tabEeg?.classList.add('bg-white/25', 'border-white/50');
    tabEeg?.classList.remove('bg-white/10', 'border-white/20');
    tabMri?.classList.remove('bg-white/25', 'border-white/50');
    tabMri?.classList.add('bg-white/10', 'border-white/20');

    // Hero gradient
    hero?.classList.remove('from-purple-700', 'via-purple-600', 'to-indigo-500');
    hero?.classList.add('from-amber-700', 'via-amber-600', 'to-yellow-500');

    // Content
    eegContent?.classList.remove('hidden');
    mriContent?.classList.add('hidden');

    // Subtitle
    if (subtitle) subtitle.textContent = 'Interactive annotated EEG patterns organized from basic to advanced. Click or hover on numbered markers to explore key features.';

    // Stats
    eegStats?.classList.remove('hidden');
    mriStats?.classList.add('hidden');
  }

  function switchToMri() {
    // Tab styles
    tabMri?.classList.add('bg-white/25', 'border-white/50');
    tabMri?.classList.remove('bg-white/10', 'border-white/20');
    tabEeg?.classList.remove('bg-white/25', 'border-white/50');
    tabEeg?.classList.add('bg-white/10', 'border-white/20');

    // Hero gradient
    hero?.classList.remove('from-amber-700', 'via-amber-600', 'to-yellow-500');
    hero?.classList.add('from-purple-700', 'via-purple-600', 'to-indigo-500');

    // Content
    mriContent?.classList.remove('hidden');
    eegContent?.classList.add('hidden');

    // Subtitle
    if (subtitle) subtitle.textContent = 'Interactive annotated brain imaging patterns for pediatric neurology. Click or hover on numbered markers to explore key findings.';

    // Stats
    mriStats?.classList.remove('hidden');
    eegStats?.classList.add('hidden');
  }

  tabEeg?.addEventListener('click', switchToEeg);
  tabMri?.addEventListener('click', switchToMri);

  // ==================== DIFFICULTY FILTER (EEG) ====================
  const eegFilterBtns = document.querySelectorAll('.eeg-filter-btn');
  const eegCards = document.querySelectorAll('#eeg-card-grid .eeg-atlas-card');
  const eegSections = document.querySelectorAll('.eeg-section');

  eegFilterBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const filter = btn.getAttribute('data-filter');
      eegFilterBtns.forEach(b => {
        b.classList.remove('active', 'bg-blue-600', 'text-white');
        b.classList.add('bg-slate-100', 'text-slate-600');
      });
      btn.classList.add('active', 'bg-blue-600', 'text-white');
      btn.classList.remove('bg-slate-100', 'text-slate-600');

      eegCards.forEach(card => {
        const difficulty = card.getAttribute('data-difficulty');
        (card as HTMLElement).style.display = (filter === 'all' || difficulty === filter) ? '' : 'none';
      });
      eegSections.forEach(section => {
        const sectionType = section.getAttribute('data-section');
        (section as HTMLElement).style.display = (filter === 'all' || sectionType === filter) ? '' : 'none';
      });
    });
  });

  // ==================== DIFFICULTY FILTER (MRI) ====================
  const mriFilterBtns = document.querySelectorAll('.mri-filter-btn');
  const mriCards = document.querySelectorAll('#mri-card-grid .eeg-atlas-card');
  const mriSections = document.querySelectorAll('.mri-section');

  mriFilterBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const filter = btn.getAttribute('data-filter');
      mriFilterBtns.forEach(b => {
        b.classList.remove('active', 'bg-purple-600', 'text-white');
        b.classList.add('bg-slate-100', 'text-slate-600');
      });
      btn.classList.add('active', 'bg-purple-600', 'text-white');
      btn.classList.remove('bg-slate-100', 'text-slate-600');

      mriCards.forEach(card => {
        const difficulty = card.getAttribute('data-difficulty');
        (card as HTMLElement).style.display = (filter === 'all' || difficulty === filter) ? '' : 'none';
      });
      mriSections.forEach(section => {
        const sectionType = section.getAttribute('data-section');
        (section as HTMLElement).style.display = (filter === 'all' || sectionType === filter) ? '' : 'none';
      });
    });
  });

  // ==================== URL HASH SUPPORT ====================
  const hash = window.location.hash.slice(1);
  if (hash) {
    if (hash === 'brain-imaging' || hash === 'mri') {
      switchToMri();
    } else {
      // Check if hash matches an MRI pattern
      const mriTarget = document.querySelector(`#mri-content #${hash}`);
      if (mriTarget) {
        switchToMri();
        setTimeout(() => {
          mriTarget.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 300);
      } else {
        const eegTarget = document.getElementById(hash);
        if (eegTarget) {
          setTimeout(() => {
            eegTarget.scrollIntoView({ behavior: 'smooth', block: 'center' });
          }, 300);
        }
      }
    }
  }
</script>
